<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap');

    body {
      font-family: 'Roboto', sans-serif;
      font-size: 13px;
    }

    .searchForm {
      margin-bottom: 25px;
    }

    .inputWrapper {
      margin: 10px 0;
      display: flex;
      align-items: center;
    }

    .inputWrapper input,
    .inputWrapper select {
      padding: 5px;
      margin-left: 10px;
    }

    .inputWrapper label {
      min-width: 150px;
    }

    .searchForm button {
      border: unset;
      background: darkblue;
      color: #fff;
      padding: 7px 15px;
      cursor: pointer;
      margin-top: 15px;
    }

    .resultWrapper {
      display: none;
    }

    .resultWrapper.isShown {
      display: block;
    }

    .resultOutput {
      display: flex;
      flex-wrap: wrap;
      align-items: stretch;
      justify-content: flex-start;
    }

    .filmItem {
      width: calc(33% - 20px);
      padding: 5px;
      margin: 5px 5px 5px 0;
      border: 1px solid #b8b8b8;
      display: flex;
      flex-direction: column;
    }

    .filmItem img {
      max-width: 100%;
    }

    .filmItem_year {
      color: #b8b8b8;
      margin-top: auto;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <h1>Поиск по базе фильмов OMDB</h1>
    <form class="searchForm">
      <div class="inputWrapper">
        <label for="searchInput">Поиск по названию:</label>
        <input id="searchInput" type="search" class="input" required />
        <!--type:search отличется от text тем что справа в углу появляется крестик нажав на который можно убрать содержимое что удобно-->
      </div>
      <div class="inputWrapper">
        <label for="typeInput">Тип:</label>
        <select id="typeInput">
          <option value="">Выберите тип</option><!--в value ничего нет если нам не важно какая-либо опция (проще говоря по умолчанию)-->
          <option value="movie">Фильм</option>
          <option value="series">Сериал</option>
        </select>
      </div>
      <div class="inputWrapper">
        <label for="yearInput">Год выпуска:</label>
        <input id="yearInput" type="number"/> <!-- type="number" позволяет нам вводить только цифры -->
      </div>
      <button type="submit">Поиск</button>
    </form>
    <hr />
    <div class="resultWrapper">
      <h2>Результаты поиска</h2>
      <div class="resultOutput"></div>
    </div>
  </div>

  <script>
    const apiKey = "da102ad5";
    const apiUrl = "https://www.omdbapi.com/";

    const form = document.querySelector('.searchForm');
    const resultWrapper = document.querySelector('.resultWrapper');
    form.addEventListener('submit', submitForm);

    function submitForm(e){//обьект события
      e.preventDefault();
      const searchValue = form.querySelector('#searchInput').value; //сужаем ареал поиска
      const typeValue = form.querySelector('#typeInput').value;
      const yearValue = form.querySelector('#yearInput').value;
      //&s= парамет р отвечающий за поиск
      //? - означает что пошли параметры get запроса
      //apikey=${apiKey} - ключ к api браузера
      const params = new URLSearchParams();
      params.append('apikey', apiKey); //имя параметра и значение
      params.append('s', searchValue);
      params.append('type', typeValue); 
      params.append('y', yearValue);
      fetch(`${apiUrl}?${params}`)
      //fetch(`${apiUrl}?apikey=${apiKey}&s=${searchValue}`)
        .then(data => data.json())//переводим данные в нужный формат
        .then(data => {
          console.log(data);
          clearResultOutput(); //идет проверка есть ли данные если есть то добавляются в output а потом очищаются
          const output = resultWrapper.querySelector('.resultOutput'); 
          if(data.Response ==='True'){//response = 'false' будет в случае если ничего не найдено по запросу пользователя 
            data.Search.forEach(film =>{//результаты записаны в массиве и нужно пройтись по каждому элементу в массиве 
              const filmTemplate = `
              <div class="filmItem">
                <h3>${film.Title}</h3>
                <img src=${film.Poster} alt='${film.Title}'/>
                <p class='filmItem_year'>${film.Year}</p>
              </div>
              `;
              output.innerHTML += filmTemplate;
            });
          } else {
            output.innerHTML='<p>По вашему звпросу ничего не нашлось</p>';
          };
          showResultOutput();
      });
    };

    function clearResultOutput(){
      resultWrapper.classList.remove('isShown');
      const output = resultWrapper.querySelector('.resultOutput');
      output.innerHTML='';
    }

    function showResultOutput(){
      resultWrapper.classList.add('isShown');
    }

  </script>
</body>
</html>